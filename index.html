<!DOCTYPE html>
<html>
  
  <!--all resources are copied from https://vuetifyjs.com/en/components/buttons/-->
  <head>
    <script src="https://kit.fontawesome.com/3b1eb95a59.js" crossorigin="anonymous"></script>
  <link
    href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css"
    rel="stylesheet"
    />
  <link
    href="https://cdn.jsdelivr.net/npm/vuetify@3.0.5/dist/vuetify.min.css"
    rel="stylesheet"
    />
</head>
  <body>
    <div id="app"></div>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@3.0.5/dist/vuetify.min.js"></script>
    <script type="text/x-template" id="app-template">
      <v-app>
   
        <v-container class="text-center">
          <v-row flex-wrap="wrap" justify="space-between">
            <v-card width="400">
              
              <div>
                <v-row align-items-center justify-content-center>
                 
                </v-row>
              </div>
            </v-card>
          </v-row>
        </v-container>
      
        <v-card
          class="mx-auto"
          width="400"
          append-icon="mdi-human-greeting"
          color=grey
        >
        
          <template v-slot:title>
            {{header}}
            <v-text-field class="text-center zipCode" v-model="zipCode" label="Enter your zip code"></v-text-field>
            <v-btn color="primary" @click="fetchWeatherData">Get Weather</v-btn>
          <!-- Weather data display code goes here -->
          </template>
          <v-card-text>
            <template v-slot:title>
              {{weather}}
            </template>
            <div class="font-weight-bold mb-3 font-size 2em">
              Weather Condition
            </div>
            <div>
              Your location has <span class="weather"> Condition</span>.
            </div>
          </v-card-text>

            <v-card-text>
              <div class="font-weight-bold mb-3 font-size 2em" id="location" >
                Place Name
              </div>
  
              <div class="justify-space-around">
                <div class="Fahrenheit">
                  Temperature F
                </div>
  
                <div class="Celcius">
                  Temperature C
                </div>
              </div>
            </v-card-text>
          </v-col>
          </v-card-text>
        </v-card>
        
        <v-card
          class="mx-auto"
          width="400"
          append-icon="mdi-cloud"
          color=lightgrey
          ref="myCard"
        >
          <template v-slot:title>
            {{sunrise}}
          </template>
          <v-card-text>
            <div>
            Sunrise: <span class="sunrise"> Condition</span>.
            </div>
            <div>
              Sunset: <span class="sunset"> Condition</span>.
              </div>
          </v-card-text>
        </v-card>
        
        <v-card
          class="mx-auto"
          
          title="Don't forget your umberella"
          subtitle="today's weather"
          text="Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat."
          width="400"
        >
          <v-card-actions >
            <a href="tomorrow.html"><v-btn>Tomorrow</v-btn></a>
          </v-card-actions>
        </v-card>
      
        <v-container class="container" >
          <v-row justify="space-around" >
            <v-card width="400">
              <v-col>
              
      
              <v-container class="text-center">
                <v-row justify="space-around">
                  <v-card width="400">
                   
                  </v-card>
                </v-row>
              </v-container>
            </v-card>
      
            <v-container class="text-center">
              <v-row justify="space-around">
                <v-card width="400">
                </v-card>
              </v-row>
            </v-container>


  <v-bottom-navigation
        width="400px">
  <v-btn value="recent">
    <v-icon>mdi-history</v-icon>

    Recent
  </v-btn>

  <v-btn value="favorites">
    <v-icon>mdi-heart</v-icon>

    Favorites
  </v-btn>

  <v-btn value="nearby">
    <v-icon>mdi-map-marker</v-icon>

    Nearby
  </v-btn>
   <v-btn value="alendar">
    <v-icon>mdi-calendar</v-icon>

    Forecast
  </v-btn>
</v-bottom-navigation>
        
      </v-app>
    </script>
    <script>
      const { createApp } = Vue;
      const { createVuetify } = Vuetify;
      
      const vuetify = createVuetify();
      
      const app = createApp({
  template: "#app-template",
  data() {
    return {
      sunrise: "Sun rise & set",
      weather:"weather Condition",
      title:"title",
      detail:"detail",
      zipCode: "",
    };
  },
  mounted() {
    const cardElement = this.$refs.myCard;
    // Retrieve the user's zip code from local storage
    const storedZipCode = localStorage.getItem("zipCode");
    if (storedZipCode) {
      this.zipCode = storedZipCode;
    }
  },

  watch: {
    // Save the user's zip code to local storage when it changes
    zipCode(newZipCode) {
      localStorage.setItem("zipCode", newZipCode);
    }
  }
})
.use(vuetify)
.mount("#app");

    // Openweathermap API. Do not share it publicly.
const api = '713c23c0545cd0de3150dfe7dc9bab15';




const iconImg = document.getElementById('weather-icon');
const Address = document.querySelector('#location');
const Celcius = document.querySelector('.Celcius');
const Fahrenheit = document.querySelector('.Fahrenheit');
const description = document.querySelector('.description');
const weather = document.querySelector('.weather');
const sunriseData = document.querySelector('.sunrise');
const sunsetData = document.querySelector('.sunset');



window.addEventListener('load', () => {
 // Accesing Geolocation of User
 if (navigator.geolocation) {
   navigator.geolocation.getCurrentPosition((position) => {
     // Storing Longitude and Latitude in variables
     Longitude = position.coords.longitude;
     Latitude = position.coords.latitude;
     
     const base = `https://api.openweathermap.org/data/2.5/weather?lat=${Latitude}&lon=${Longitude}&appid=${api}&units=metric`;


     // Using fetch to get data
     fetch(base)
       .then((response) => {
         return response.json();
       })
       .then((data) => {
        console.log (data);
         const { temp, feels_like } = data.main;
         const place = data.name;
         const { description, icon } = data.weather[0];
         const { sunrise, sunset } = data.sys;

         const fahrenheit = (temp * 9) / 5 + 32;
         // Converting Epoch(Unix) time to GMT
         const sunriseGMT = new Date(sunrise * 1000);
         const sunsetGMT = new Date(sunset * 1000);


         // Interacting with DOM to show data
         Address.textContent = `${place}`;
         description.textContent = `${description}`;
         weather.textContent = `${description}`;
         Celcius.textContent = `${temp.toFixed(2)} 째C`;
         Fahrenheit.textContent = `${fahrenheit.toFixed(2)} 째F`;
         sunriseData.textContent = `${sunriseGMT.toLocaleDateString()}, ${sunriseGMT.toLocaleTimeString()}`;
         sunsetData.textContent = `${sunsetGMT.toLocaleDateString()}, ${sunsetGMT.toLocaleTimeString()}`;
       })
       .catch((error) => {
          console.error("Error fetching weather data:", error);
        });
    });
  
     // Retrieving the user's zip code from local storage
     const storedZipCode = localStorage.getItem("zipCode");
    if (storedZipCode) {
      // Call the fetchWeatherData method with the stored zip code
      fetchWeatherData(storedZipCode);
    }
  }
});
function fetchWeatherData(zipCode) {
  ZipCode = position.coords.ZipCode;
  const url = `https://api.openweathermap.org/data/2.5/weather?zip=${zipCode}&appid=${apiKey}`;
      fetch(url)
        .then((response) => response.json())
        .then((data) => {
          // Extract the weather data from the response
          console.log(data);
          const { temp, feels_like } = data.main;
          const place = data.name;
          const { description, icon } = data.weather[0];
          const { sunrise, sunset } = data.sys;

          const fahrenheit = (temp * 9) / 5 + 32;
          // Converting Epoch(Unix) time to GMT
          const sunriseGMT = new Date(sunrise * 1000);
          const sunsetGMT = new Date(sunset * 1000);

          // Interacting with DOM to show data
          Address.textContent = `${place}`;
         description.textContent = `${description}`;
         weather.textContent = `${description}`;
         Celcius.textContent = `${temp.toFixed(2)} 째C`;
         Fahrenheit.textContent = `${fahrenheit.toFixed(2)} 째F`;
         sunriseData.textContent = `${sunriseGMT.toLocaleDateString()}, ${sunriseGMT.toLocaleTimeString()}`;
         sunsetData.textContent = `${sunsetGMT.toLocaleDateString()}, ${sunsetGMT.toLocaleTimeString()}`;
       })
       .catch((error) => {
          console.error("Error fetching weather data:", error);
        });
    }
   </script>

    </script>
  </body>
</html>